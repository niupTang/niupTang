---
title: "GitHub é«˜æ˜Ÿé¡¹ç›® nanoGPTï¼šå°ç™½è½»æ¾è®­ç»ƒä¸“å±?GPT æ¨¡å‹ï¼Œæ–°æ‰‹ä¹Ÿèƒ½å¿«é€Ÿä¸Šæ‰?
permalink: github-é«˜æ˜Ÿé¡¹ç›®-nanogpt-å°ç™½è½»æ¾è®­ç»ƒä¸“å±-gpt-æ¨¡å‹-æ–°æ‰‹ä¹Ÿèƒ½å¿«é€Ÿä¸Šæ‰?
date: 2025-10-15 22:12:20
tags:
  - å…¬ä¼—å?
  - åŸåˆ›
categories:
  - å…¬ä¼—å·æ–‡ç«?
---

### **æ¨èé˜…è¯»**
â€?Â Â [Github èµ„æ–™é¡¹ç›®åˆé›†](https://mp.weixin.qq.com/s?__biz=MzkyNDYyODg0MQ==&mid=2247488210&idx=1&sn=9b97cc6da4bdaf42ba779d4d0d66f5a1&scene=21#wechat_redirect)

â€¢Â [Â ](https://mp.weixin.qq.com/s?__biz=MzkyNDYyODg0MQ==&mid=2247485065&idx=1&sn=8b71c116b61add064e0892da63a7bf6d&scene=21#wechat_redirect)Â [50ä¸?AI å¼€æºé¡¹ç›®åˆé›†](https://mp.weixin.qq.com/s?__biz=MzkyNDYyODg0MQ==&mid=2247489466&idx=1&sn=656577c7880b921ed675c55ba12c1c09&scene=21#wechat_redirect)â€¢Â [Â Â ](https://mp.weixin.qq.com/s?__biz=MzkyNDYyODg0MQ==&mid=2247485065&idx=1&sn=8b71c116b61add064e0892da63a7bf6d&scene=21#wechat_redirect)[80 æ¬¾AI å¼€æºåˆé›†](https://mp.weixin.qq.com/s?__biz=MzkyNDYyODg0MQ==&mid=2247489951&idx=1&sn=eb4684ba6062440ea2939bd2a9772fc0&scene=21#wechat_redirect)

* æˆ³ä¸Šæ–¹è“å­—â€?*ç‰›çš®ç³–ä¸å¹ç‰›**â€å…³æ³¨æˆ‘

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ ç‰›çš®ç³–ï¼åœ?AI çš„æŒç»­å‘å±•ï¼Œå¾ˆå¤šå°ä¼™ä¼´æƒ³è‡ªå·±è®­ç»ƒå¤§æ¨¡å?ï¼Œå´è¢«å¤æ‚çš„ä»£ç å’Œé«˜æ˜‚çš„è®¾å¤‡é—¨æ§›å“é€€äº†ï¼Ÿåˆ«æ‹…å¿ƒï¼Œä»Šå¤©æˆ‘å°±æ¥ç»™å¤§å®¶ä»‹ç»ä¸‹è‡ªå·?â€”â€?ä¸€ä¸ªèƒ½è®©ä½ è½»æ¾è®­ç»ƒå’Œå¾®è°ƒä¸­ç­‰è§„æ¨?GPT æ¨¡å‹çš„å¼€æºå·¥å…·ï¼Œå“ªæ€•æ˜¯æ–°æ‰‹ä¹Ÿèƒ½å¿«é€Ÿä¸Šæ‰‹ï½

è¿™ä¸ªå¼€æºé¡¹ç›®ä»æœ€å¼€å§‹çš„ miniGPT åˆ?å…ˆçš„ nanoGPT .

![](https://mmbiz.qpic.cn/mmbiz_png/p1ESIQQvfrSGoutS7k1YDKpeOOAricia3BlWR4OqUpXZOKZPKZLxPD5YY20U6gbJyNShicoxJv3vCRkoSr4DgoMQw/640?wx_fmt=png&from=appmsg)

# nanoGPT ç®€ä»?
nanoGPT æ˜¯ä¸€ä¸ªç”¨äºè®­ç»ƒå’Œå¾®è°ƒä¸­ç­‰è§„æ¨¡ GPT æ¨¡å‹çš„ç®€å•ã€å¿«é€Ÿçš„ä»£ç åº“ã€‚å®ƒçš„è®¾è®¡ç†å¿µæ˜¯ç®€æ´æ˜“æ‡‚ï¼Œä¾¿äºç”¨æˆ·æ ¹æ®è‡ªèº«éœ€æ±‚è¿›è¡Œä¿®æ”¹ï¼Œæ— è®ºæ˜¯ä»å¤´å¼€å§‹è®­ç»ƒæ–°æ¨¡å‹ï¼Œè¿˜æ˜¯åŸºäºé¢„è®­ç»ƒ checkpoint è¿›è¡Œå¾®è°ƒï¼ˆä¾‹å¦?OpenAI çš?GPT-2 1.3B æ¨¡å‹ï¼‰ã€?

![](https://mmbiz.qpic.cn/mmbiz_png/p1ESIQQvfrSGoutS7k1YDKpeOOAricia3BVeVlrtem3zALoQBIKgxNGVBcr6GQIC3WEic3QLoug0scQaiaxTia9Ge5Q/640?wx_fmt=png&from=appmsg)

## ä¸»è¦ç‰¹ç‚¹
- â€¢Â?*ç®€æ´é«˜æ•?*ï¼šä»£ç ç»“æ„ç®€å•ï¼Œæ˜“äºç†è§£å’Œä¿®æ”¹ï¼ŒåŒæ—¶ä¿æŒäº†è¾ƒé«˜çš„è®­ç»ƒæ•ˆç‡ã€?

- â€¢Â?*çµæ´»æ€§å¼º**ï¼šæ”¯æŒä»å¤´è®­ç»ƒã€ä»é¢„è®­ç»ƒæ¨¡å‹å¾®è°ƒç­‰å¤šç§ä½¿ç”¨åœºæ™¯ã€?

- â€¢Â?*æ”¯æŒå¤šç§è®¾å¤‡**ï¼šå¯åœ?GPUã€CPU ç”šè‡³ Apple Silicon Macbooksï¼ˆä½¿ç”¨Â `--device=mps`ï¼‰ä¸Šè¿è¡Œã€?

- â€¢Â?*é›†æˆä¸»æµå·¥å…·**ï¼šç»“åˆäº† PyTorchã€transformersã€datasets ç­‰å¸¸ç”¨æ·±åº¦å­¦ä¹ å·¥å…·ã€?

## å®‰è£…ä¾èµ–
`pip install torch numpy transformers datasets tiktoken wandb tqdm`ä¾èµ–è¯´æ˜ï¼?

- â€?pytorchï¼šæ·±åº¦å­¦ä¹ æ¡†æ?

- â€?numpyï¼šæ•°å€¼è®¡ç®—åº“

- â€?transformersï¼šç”¨äºåŠ è½?GPT-2 ç­‰é¢„è®­ç»ƒæ¨¡å‹

- â€?datasetsï¼šç”¨äºä¸‹è½½å’Œé¢„å¤„ç†æ•°æ®é›†ï¼ˆå¦‚ OpenWebTextï¼?

- â€?tiktokenï¼šOpenAI çš„å¿«é€?BPE ç¼–ç å·¥å…·

- â€?wandbï¼šå¯é€‰çš„æ—¥å¿—è®°å½•å·¥å…·

- â€?tqdmï¼šè¿›åº¦æ¡æ˜¾ç¤ºå·¥å…·

## å¿«é€Ÿå¼€å§?
### åœ?GPU ä¸Šè®­ç»?
ä»¥å­—ç¬¦çº§æ¨¡å‹è®­ç»ƒèå£«æ¯”äºšæ–‡æœ¬ä¸ºä¾‹ï¼?

`python train.py config/train_shakespeare_char.py`è®­ç»ƒå®Œæˆåç”Ÿæˆæ ·æœ¬ï¼š

`python sample.py --out_dir=out-shakespeare-char`### åœ?CPU ä¸Šè®­ç»?
![](https://mmbiz.qpic.cn/mmbiz_png/p1ESIQQvfrSGoutS7k1YDKpeOOAricia3B7rv36TJicwcUJoLzbFfUFR6ay0keFwIo7LuUsicoaklSAnzcoZ782lpQ/640?wx_fmt=png&from=appmsg)

å¦‚æœåªæœ‰æ™®é€šç”µè„‘ï¼ˆå¦?MacBookï¼‰ï¼Œå¯ä»¥é™ä½è®­ç»ƒè§„æ¨¡ï¼?

`python train.py config/train_shakespeare_char.py --device=cpu --compile=False --eval_iters=20 --log_interval=1 --block_size=64 --batch_size=12 --n_layer=4 --n_head=4 --n_embd=128 --max_iters=2000 --lr_decay_iters=2000 --dropout=0.0`ç”Ÿæˆæ ·æœ¬ï¼?

`python sample.py --out_dir=out-shakespeare-char --device=cpu`## å¤ç° GPT-2
### æ•°æ®å‡†å¤‡
é¦–å…ˆå¤„ç† OpenWebText æ•°æ®é›†ï¼š

`python data/openwebtext/prepare.py`è¯¥å‘½ä»¤ä¼šä¸‹è½½å¹?tokenize æ•°æ®é›†ï¼Œç”ŸæˆÂ `train.bin`Â å’ŒÂ `val.bin`Â æ–‡ä»¶ã€?

### è®­ç»ƒ
åœ¨æ‹¥æœ?8 å¼?A100 40GB GPU çš„èŠ‚ç‚¹ä¸Šï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤å¤ç?GPT-2ï¼?24M å‚æ•°ï¼‰ï¼š

`torchrun --standalone --nproc_per_node=8 train.py config/train_gpt2.py`å¤§çº¦éœ€è¦?4 å¤©æ—¶é—´ï¼Œæ¨¡å‹æŸå¤±ä¼šé™è‡?~2.85 å·¦å³ã€?

### å¤šèŠ‚ç‚¹è®­ç»?
åœ¨é›†ç¾¤ç¯å¢ƒä¸­ï¼Œå¯ä»¥ä½¿ç”¨å¤šèŠ‚ç‚¹è®­ç»ƒï¼?

`# åœ¨ä¸»èŠ‚ç‚¹ï¼ˆç¤ºä¾?IP 123.456.123.456ï¼‰ä¸Šè¿è¡Œ
torchrun --nproc_per_node=8 --nnodes=2 --node_rank=0 --master_addr=123.456.123.456 --master_port=1234 train.py

# åœ¨å·¥ä½œèŠ‚ç‚¹ä¸Šè¿è¡Œ
torchrun --nproc_per_node=8 --nnodes=2 --node_rank=1 --master_addr=123.456.123.456 --master_port=1234 train.py`å¦‚æœæ²¡æœ‰ Infiniband äº’è¿ï¼Œéœ€è¦åœ¨å‘½ä»¤å‰æ·»åŠ Â `NCCL_IB_DISABLE=1`ã€?

## å¾®è°ƒ
å¾®è°ƒä¸è®­ç»ƒç±»ä¼¼ï¼Œåªéœ€ç¡®ä¿ä»é¢„è®­ç»ƒæ¨¡å‹åˆå§‹åŒ–ï¼š

`python train.py config/finetune_shakespeare.py`## é‡‡æ ·/æ¨ç†
ä½¿ç”¨Â `sample.py`Â è„šæœ¬ä»é¢„è®­ç»ƒæ¨¡å‹æˆ–è‡ªå·±è®­ç»ƒçš„æ¨¡å‹ä¸­é‡‡æ ·ï¼š

`python sample.py \
Â  Â  --init_from=gpt2-xl \
Â  Â  --start="What is the answer to life, the universe, and everything?"Â \
Â  Â  --num_samples=5 --max_new_tokens=100`å¦‚æœè¦ä»è‡ªå·±è®­ç»ƒçš„æ¨¡å‹é‡‡æ ·ï¼Œä½¿ç”¨Â `--out_dir`Â æŒ‡å®šæ¨¡å‹ç›®å½•ã€?

https://github.com/karpathy/nanoGPT

![](https://mmbiz.qpic.cn/mmbiz_gif/7ibzJsmgW5wguO21SlkBAdxJgAicEOVCzDiaObyzEAEMTI527clib7gHvKfBtDu8MJZLwwEIVuVBmqfn01fmLDdTfQ/640?wx_fmt=gif&tp=webp&wxfrom=5&wx_lazy=1)

Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·ENDÂ·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·

AI æ—¶ä»£åˆ°æ¥ï¼Œè¦å¤§å…¬å¸å˜å°ï¼Œå°å…¬å¸æ¶ˆå¤±ã€‚åœ¨å½“ä¸‹æœ€å¥½å‘å±•ä¸€ä»½å±äºè‡ªå·±çš„å‰¯ä¸šÂ [AI + è¡Œä¸šåšå‰¯ä¸š](https://mp.weixin.qq.com/s?__biz=MzkyNDYyODg0MQ==&mid=2247491231&idx=2&sn=bd93a7254853228d4bf8b47cb8c010df&scene=21#wechat_redirect)Â å·²ç»æœ?4000 åå°ä¼™ä¼´åŠ å…¥äº†ï¼Œå¦‚æœä½ ä¹Ÿæƒ³ç€åœ?AI æ—¶ä»£æ‹¥æœ‰ä¸€ä»½å±äºè‡ªå·±çš„ AI å‰¯ä¸šÂ [æˆ³é“¾æ¥](https://mp.weixin.qq.com/s?__biz=MzkyNDYyODg0MQ==&mid=2247491231&idx=2&sn=bd93a7254853228d4bf8b47cb8c010df&scene=21#wechat_redirect)Â åŠ å…¥å§ï¼è¿™æ˜¯ä¸€ä¸ªèµšé’±è®­ç»ƒè¥ï¼ŒAI æŠ€èƒ½è®­ç»ƒè¥å¯†é›†çš„åœˆå­ï¼Œä½ å¯ä»¥æ¯å¹´å‚åŠ å„ç§å‰¯ä¸šèµšé’±è®­ç»ƒè¥ã€‚å…¬ä¼—å·åå°å›å¤AI å‰¯ä¸šæ˜Ÿçƒå³å¯è·å–26å…ƒä¼˜æƒ åŠµã€?

Â 

![](https://mmbiz.qpic.cn/mmbiz_jpg/p1ESIQQvfrRZtBIbJCBg4nGyNgf5ltJzNx8KicPolicKxggSbwj7shkplcqEqRIAlLgBzlrQ8pla7sm9EUAzEnTA/640?wx_fmt=jpeg&from=appmsg)

**å…³äºAIå·¥å…·**

[Githubå¼€æºæ–‡æœ¬è½¬è¯­éŸ³ç¥å™¨Spark-TTSå¼€æºäº†ï¼Œå…‹éš†å£°éŸ³ä»…éœ€3ç§’ï¼Ÿ](https://mp.weixin.qq.com/s?__biz=MzkyNDYyODg0MQ==&mid=2247489399&idx=1&sn=a760a00d1e7e36a2cfc74762b6e4d685&scene=21#wechat_redirect)

[githubå¼€æºBç«™UPä¸»éƒ½åœ¨ç”¨çš„ä¸‹è½½ç¥å™¨ï¼Cobaltè®©ä½ è½»æ¾æ¬è¿é«˜æ¸…ç´ æï¼](https://mp.weixin.qq.com/s?__biz=MzkyNDYyODg0MQ==&mid=2247489630&idx=1&sn=d8ce8eabdf418a67b4aa6cd2aaf093c8&scene=21#wechat_redirect)

[Github 26k Stars å¼€æºæ¢è„¸ç¥å™¨](https://mp.weixin.qq.com/s?__biz=MzkyNDYyODg0MQ==&mid=2247486822&idx=1&sn=9a45d16ce51f161bff37a5982965ad05&scene=21#wechat_redirect)

[Github å¼€æºæ— ä»£ç çš?Web æ•°æ®æå–å¹³å°ï¼?åˆ†é’Ÿå†…è®­ç»ƒæœºå™¨äººè‡ªåŠ¨æŠ“å–ç½‘é¡µæ•°æ®](https://mp.weixin.qq.com/s?__biz=MzkyNDYyODg0MQ==&mid=2247487477&idx=1&sn=05c86cb5a688db02d134b04710f020e1&scene=21#wechat_redirect)