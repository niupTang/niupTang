<%- partial('_partial/hero') %>

    <section class="tools-section">
        <div class="section-container">
            <!-- åˆ†ç±»æ ‡ç­¾ -->
            <div class="category-tabs">
                <button class="tab-btn active" data-category="all">
                    <span class="tab-icon">â­</span>
                    ç²¾é€‰å·¥å…·
                </button>
                <button class="tab-btn" data-category="text">
                    <span class="tab-icon">ğŸ“</span>
                    æ–‡æœ¬å·¥å…·
                </button>
                <button class="tab-btn" data-category="image">
                    <span class="tab-icon">ğŸ–¼ï¸</span>
                    å›¾åƒå·¥å…·
                </button>
                <button class="tab-btn" data-category="video">
                    <span class="tab-icon">ğŸ¬</span>
                    è§†é¢‘å·¥å…·
                </button>
                <button class="tab-btn" data-category="audio">
                    <span class="tab-icon">ğŸµ</span>
                    éŸ³é¢‘å·¥å…·
                </button>
                <button class="tab-btn" data-category="efficiency">
                    <span class="tab-icon">âš¡</span>
                    æ•ˆç‡å·¥å…·
                </button>
            </div>

            <!-- å·¥å…·ç½‘æ ¼ -->
            <div class="tools-grid">
                <% if (site.data.tools && site.data.tools.items) { %>
                    <% site.data.tools.items.forEach(function(tool) { %>
                        <%- partial('_partial/tool-card', {tool: tool}) %>
                            <% }); %>
                                <% } else { %>
                                    <!-- ç¤ºä¾‹å·¥å…·å¡ç‰‡ï¼ˆæ— æ•°æ®æ—¶æ˜¾ç¤ºï¼‰ -->
                                    <article class="tool-card" data-category="all">
                                        <div class="tool-icon">ğŸ¤–</div>
                                        <div class="tool-info">
                                            <h3 class="tool-name">ChatGPT</h3>
                                            <p class="tool-desc">OpenAI å¼€å‘çš„å¼ºå¤§å¯¹è¯AIåŠ©æ‰‹</p>
                                        </div>
                                        <a href="https://chat.openai.com" class="tool-link" target="_blank">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2">
                                                <path d="M7 17L17 7M17 7H7M17 7V17" />
                                            </svg>
                                        </a>
                                    </article>

                                    <article class="tool-card" data-category="all">
                                        <div class="tool-icon">ğŸ¨</div>
                                        <div class="tool-info">
                                            <h3 class="tool-name">Midjourney</h3>
                                            <p class="tool-desc">AIè‰ºæœ¯å›¾åƒç”Ÿæˆå·¥å…·</p>
                                        </div>
                                        <a href="https://midjourney.com" class="tool-link" target="_blank">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2">
                                                <path d="M7 17L17 7M17 7H7M17 7V17" />
                                            </svg>
                                        </a>
                                    </article>

                                    <article class="tool-card" data-category="text">
                                        <div class="tool-icon">âœï¸</div>
                                        <div class="tool-info">
                                            <h3 class="tool-name">Claude</h3>
                                            <p class="tool-desc">Anthropic çš„æ™ºèƒ½å¯¹è¯åŠ©æ‰‹</p>
                                        </div>
                                        <a href="https://claude.ai" class="tool-link" target="_blank">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2">
                                                <path d="M7 17L17 7M17 7H7M17 7V17" />
                                            </svg>
                                        </a>
                                    </article>

                                    <article class="tool-card" data-category="image">
                                        <div class="tool-icon">ğŸ–Œï¸</div>
                                        <div class="tool-info">
                                            <h3 class="tool-name">Stable Diffusion</h3>
                                            <p class="tool-desc">å¼€æºAIå›¾åƒç”Ÿæˆæ¨¡å‹</p>
                                        </div>
                                        <a href="https://stability.ai" class="tool-link" target="_blank">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2">
                                                <path d="M7 17L17 7M17 7H7M17 7V17" />
                                            </svg>
                                        </a>
                                    </article>

                                    <article class="tool-card" data-category="video">
                                        <div class="tool-icon">ğŸ¬</div>
                                        <div class="tool-info">
                                            <h3 class="tool-name">Runway</h3>
                                            <p class="tool-desc">AIè§†é¢‘ç”Ÿæˆä¸ç¼–è¾‘å¹³å°</p>
                                        </div>
                                        <a href="https://runway.ml" class="tool-link" target="_blank">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2">
                                                <path d="M7 17L17 7M17 7H7M17 7V17" />
                                            </svg>
                                        </a>
                                    </article>

                                    <article class="tool-card" data-category="audio">
                                        <div class="tool-icon">ğŸµ</div>
                                        <div class="tool-info">
                                            <h3 class="tool-name">Suno</h3>
                                            <p class="tool-desc">AIéŸ³ä¹åˆ›ä½œç”Ÿæˆå·¥å…·</p>
                                        </div>
                                        <a href="https://suno.ai" class="tool-link" target="_blank">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2">
                                                <path d="M7 17L17 7M17 7H7M17 7V17" />
                                            </svg>
                                        </a>
                                    </article>

                                    <article class="tool-card" data-category="efficiency">
                                        <div class="tool-icon">ğŸ“Š</div>
                                        <div class="tool-info">
                                            <h3 class="tool-name">Notion AI</h3>
                                            <p class="tool-desc">æ™ºèƒ½ç¬”è®°ä¸çŸ¥è¯†ç®¡ç†</p>
                                        </div>
                                        <a href="https://notion.so" class="tool-link" target="_blank">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2">
                                                <path d="M7 17L17 7M17 7H7M17 7V17" />
                                            </svg>
                                        </a>
                                    </article>

                                    <article class="tool-card" data-category="text">
                                        <div class="tool-icon">ğŸ’¬</div>
                                        <div class="tool-info">
                                            <h3 class="tool-name">Coze</h3>
                                            <p class="tool-desc">å­—èŠ‚è·³åŠ¨çš„AI Botå¼€å‘å¹³å°</p>
                                        </div>
                                        <a href="https://coze.cn" class="tool-link" target="_blank">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2">
                                                <path d="M7 17L17 7M17 7H7M17 7V17" />
                                            </svg>
                                        </a>
                                    </article>
                                    <% } %>
            </div>
        </div>
    </section>

    <!-- æœ€æ–°åšå®¢æ–‡ç«  -->
    <section class="blog-section">
        <div class="section-container">
            <h2 class="section-title">ğŸ“š æœ€æ–°æ–‡ç«  <span class="article-count">(<%= site.posts.length %> ç¯‡)</span></h2>
            <div class="blog-grid" id="blog-grid">
                <% var allPosts=site.posts.sort('-date').toArray(); var initialCount=12; allPosts.slice(0,
                    initialCount).forEach(function(post){ %>
                    <article class="blog-card">
                        <div class="blog-meta">
                            <time datetime="<%= date(post.date, 'YYYY-MM-DD') %>">
                                <%= date(post.date, 'YYYY-MM-DD' ) %>
                            </time>
                        </div>
                        <h3 class="blog-title">
                            <a href="<%- url_for(post.path) %>">
                                <%= post.title %>
                            </a>
                        </h3>
                        <p class="blog-excerpt">
                            <%= strip_html(post.excerpt || post.content).substring(0, 100) %>...
                        </p>
                        <a href="<%- url_for(post.path) %>" class="read-more">é˜…è¯»æ›´å¤š â†’</a>
                    </article>
                    <% }); %>
            </div>

            <!-- åŠ è½½æ›´å¤šæŒ‰é’® -->
            <div class="load-more-container" id="load-more-container">
                <button class="load-more-btn" id="load-more-btn">
                    <span class="btn-text">åŠ è½½æ›´å¤š</span>
                    <span class="btn-loading" style="display:none;">åŠ è½½ä¸­...</span>
                </button>
                <p class="load-status" id="load-status"></p>
            </div>
        </div>
    </section>

    <script>
        (function () {
            // æ‰€æœ‰æ–‡ç« æ•°æ® - ä½¿ç”¨ JSON å®‰å…¨åºåˆ—åŒ–
            var allPosts = JSON.stringify(site.posts.sort('-date').toArray().map(function (post) {
                return {
                    title: post.title || 'æ— æ ‡é¢˜',
                    path: url_for(post.path),
                    date: date(post.date, 'YYYY-MM-DD'),
                    excerpt: strip_html(post.excerpt || post.content || '').substring(0, 100) + '...'
                };
            }));

            var currentIndex = 12; // å·²åŠ è½½æ•°é‡
            var batchSize = 12; // æ¯æ¬¡åŠ è½½æ•°é‡
            var blogGrid = document.getElementById('blog-grid');
            var loadMoreBtn = document.getElementById('load-more-btn');
            var loadStatus = document.getElementById('load-status');
            var loadMoreContainer = document.getElementById('load-more-container');

            // æ£€æŸ¥æ˜¯å¦è¿˜æœ‰æ›´å¤š
            function checkRemaining() {
                if (currentIndex >= allPosts.length) {
                    loadMoreBtn.style.display = 'none';
                    loadStatus.textContent = 'å·²åŠ è½½å…¨éƒ¨ ' + allPosts.length + ' ç¯‡æ–‡ç« ';
                } else {
                    loadStatus.textContent = 'å·²åŠ è½½ ' + currentIndex + ' / ' + allPosts.length + ' ç¯‡';
                }
            }

            // åŠ è½½æ›´å¤šæ–‡ç« 
            function loadMore() {
                var btnText = loadMoreBtn.querySelector('.btn-text');
                var btnLoading = loadMoreBtn.querySelector('.btn-loading');

                btnText.style.display = 'none';
                btnLoading.style.display = 'inline';

                setTimeout(function () {
                    var fragment = document.createDocumentFragment();
                    var endIndex = Math.min(currentIndex + batchSize, allPosts.length);

                    for (var i = currentIndex; i < endIndex; i++) {
                        var post = allPosts[i];
                        var article = document.createElement('article');
                        article.className = 'blog-card';
                        article.style.animation = 'fadeInUp 0.3s ease';
                        article.innerHTML =
                            '<div class="blog-meta"><time datetime="' + post.date + '">' + post.date + '</time></div>' +
                            '<h3 class="blog-title"><a href="' + post.path + '">' + post.title + '</a></h3>' +
                            '<p class="blog-excerpt">' + post.excerpt + '</p>' +
                            '<a href="' + post.path + '" class="read-more">é˜…è¯»æ›´å¤š â†’</a>';
                        fragment.appendChild(article);
                    }

                    blogGrid.appendChild(fragment);
                    currentIndex = endIndex;

                    btnText.style.display = 'inline';
                    btnLoading.style.display = 'none';

                    checkRemaining();
                }, 300);
            }

            // ç‚¹å‡»åŠ è½½æ›´å¤š
            loadMoreBtn.addEventListener('click', loadMore);

            // æ»šåŠ¨æ‡’åŠ è½½
            var isLoading = false;
            window.addEventListener('scroll', function () {
                if (isLoading || currentIndex >= allPosts.length) return;

                var scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                var windowHeight = window.innerHeight;
                var docHeight = document.documentElement.scrollHeight;

                // è·ç¦»åº•éƒ¨ 300px æ—¶è‡ªåŠ¨åŠ è½½
                if (scrollTop + windowHeight >= docHeight - 300) {
                    isLoading = true;
                    loadMore();
                    setTimeout(function () { isLoading = false; }, 500);
                }
            });

            // åˆå§‹æ£€æŸ¥
            checkRemaining();
        })();
    </script>